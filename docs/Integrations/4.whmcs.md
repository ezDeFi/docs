# WHMCS

### EzDeFi Plugin for WHMCS Installation

Please make sure that you have the ezDeFi plugin file for WHMCS. In case you don’t, click on the link below to download the file and install:

[WHMCS Marketplace](https://marketplace.whmcs.com/product/5231)

After you have your installation file, copy the files from the downloaded folder to the root of your WHMCS server.
> **Notice**:
>
> Please make sure you copy the files from the plugin folder into the root folder.

To install ezDeFi plugin, go to **Setup** -> **Payment** -> **Payment Gateway**, and upload the ezDeFi plugin setup file.

Then under **All Payment Gateways** tab, click on **ezDeFi** and your plugin is activated!

![Activate ezDeFi](../../img/whmcs-actv.png "Activate ezDeFi")

After installation completed, click on **Manage Existing Gateways**.

![Manage ezDeFi Gateway](../../img/whmcs-manage.png "Manage ezDeFi Gateway")

### EzDeFi Plugin Configuration

First, you need to register for a merchant account on ezDeFi homepage:

[ezDeFi Merchant Registration](https://merchant.ezdefi.com/register?utm_source=docs)

After registering for an account on ezDeFi, you can configure ezDeFi Plugin. Please make sure that your account on ezDeFi is ready, then move on to the next steps.


I. **Show on Order Form**: Turn On/Off ezDeFi Plugin on your store interface. This field allows ezDeFi to be the payment method for your customer.

II. **Display Name**: Change the name of the payment method on your store interface.

III. **Gateway API Url**: Equal to Gateway Endpoint. This field is automatically configured.

IV. **Gateway API Key**: The API Key of the account you registered on ezDeFi homepage. Go to your ezDeFi merchant account and paste it into this field.

V. **Website ID**: Generated after you have added your website on [merchant.ezdefi.com](https://merchant.ezdefi.com/). Go to **Sites management** -> *Your site* to view your Website ID

VI. **Manage Exception**: Use to manage exception for orders that have issues.  

Finally, don’t forget to save your configs.

![ezDeFi Gateway Settings](../../img/whmcs-setting.png "ezDeFi Gateway Settings")

### Manage Exception for ezDeFi Plugin

Click on **ezDeFi exception management**

In ezDeFi exception management, **Exception** is the record of the amount corresponding with each order. Customer’s QR code generation and amount is stored in ezDeFi exception table. This will help the merchant to handle order issues and other related problems.

I. Confirm invoice:

![Open Exception Table](../../img/whmcs-exception.png "Open Exception Table")

Select the valid order, then click on **Confirm Paid** button.

II. Change the invoice status from **Paid** to **Not paid**

![Confirm Paid](../../img/whmcs-exception1.png "Confirm Paid")

Select the order you want to change, click **Reverse** button.

III. Assign amount doesn’t belong to any order

![Assign to different invoice](../../img/whmcs-exception2.png "Assign to different invoice")

E.g: Your customer uses **Pay with any crypto currency**, but doesn’t enter the exact amount displayed in QR Code. You can go to **ezDeFi exception** to find the amount that customers paid, click on **OrderID** to find the order you want to confirm, then click on **Confirm Paid** to complete the order.

![Reverse invoice](../../img/whmcs-exception3.png "Reverse invoice")

> **Notice:**
>
> **AmountId** is the unique payment amount, generated each time the order is refreshed on the checkout page by changing a very small amount of the total price of the order, to identify the order that has the same **OrderId**. After the plugin received the **AmountId** of the completed order, it'll send back to the merchant the information of that order so the merchant will know which order did the customer pay for.

![Archived invoice](../../img/whmcs-exception4.png "Archived invoice")

IV. Choose order to assign

You can assign each amount for any order you want, or you can create a new order and assign the amount for it.
Sequence: Click on **Choose order to assign** -> Select 1 order -> Click on **Assign**.

V. Search

**ezDeFi exception management** supports search based on **Amount**, **OrderID**, **Currency**, **Email**, **Payment method**, **Status**.

### EzDeFi Payment

Step 1: Select ezDeFi Payment method, click on **Complete Order**

Step 2: The system will display ezDeFi QR Code, it will select the first coin/token by default.

![WHMCS QR Code](../../img/whmcs-qr.png "WHMCS QR Code")

Step 3: Select the preferred payment wallet, if you use wallet other than ezDeFi Wallet, please select **Pay with any crypto currency wallet** and enter the right amount on the QR Code to complete the payment. Otherwise, if you use ezDeFi Wallet, please select **Pay with ezDeFi wallet** to complete the payment.

> **Notice:** 
> 
> We recommend *ezDeFi Wallet* for smoother and easier checkout.
